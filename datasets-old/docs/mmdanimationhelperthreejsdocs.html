<!DOCTYPE html><html><head><title>MMDAnimationHelper – three.js docs</title></head><body><body>
		<h1>MMDAnimationHelper</h1>

		<p class="desc"> A animation helper for <a href="https://sites.google.com/view/evpvp/"><code class="inline prettyprint" translate="no"><span class="pln">MMD</span></code></a> resources. <br><br>
		MMDAnimationHelper handles animation of MMD assets loaded by <a class="links" data-fragment="MMDLoader" title="MMDLoader" href="./index.html#examples/en/loaders/MMDLoader">MMDLoader</a> with MMD special features as IK, Grant, and Physics.
		It uses <a class="links" data-fragment="CCDIKSolver" title="CCDIKSolver" href="./index.html#examples/en/animations/CCDIKSolver">CCDIKSolver</a> and <a class="links" data-fragment="MMDPhysics" title="MMDPhysics" href="./index.html#examples/en/animations/MMDPhysics">MMDPhysics</a> inside.
		</p>

		<h2>Import</h2>

		<p>
			MMDAnimationHelper is an add-on, and must be imported explicitly.
			See <a href="#manual/introduction/Installation" target="_blank">Installation / Addons</a>.
		</p>

		<code class=" prettyprint" translate="no"><span class="kwd">import</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">MMDAnimationHelper</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">from</span><span class="pln"> </span><span class="str">'three/addons/animation/MMDAnimationHelper.js'</span><span class="pun">;</span></code>

		<h2>Code Example</h2>

		<code class=" prettyprint" translate="no"><span class="com">// Instantiate a helper</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> helper </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MMDAnimationHelper</span><span class="pun">();</span><span class="pln">

</span><span class="com">// Load MMD resources and add to helper</span><span class="pln">
</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MMDLoader</span><span class="pun">().</span><span class="pln">loadWithAnimation</span><span class="pun">(</span><span class="pln">
	</span><span class="str">'models/mmd/miku.pmd'</span><span class="pun">,</span><span class="pln">
	</span><span class="str">'models/mmd/dance.vmd'</span><span class="pun">,</span><span class="pln">
	</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> mmd </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

		helper</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln"> mmd</span><span class="pun">.</span><span class="pln">mesh</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			animation</span><span class="pun">:</span><span class="pln"> mmd</span><span class="pun">.</span><span class="pln">animation</span><span class="pun">,</span><span class="pln">
			physics</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
		</span><span class="pun">}</span><span class="pln"> </span><span class="pun">);</span><span class="pln">

		scene</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln"> mmd</span><span class="pun">.</span><span class="pln">mesh </span><span class="pun">);</span><span class="pln">

		</span><span class="kwd">new</span><span class="pln"> THREE</span><span class="pun">.</span><span class="typ">AudioLoader</span><span class="pun">().</span><span class="pln">load</span><span class="pun">(</span><span class="pln">
			</span><span class="str">'audios/mmd/song.mp3'</span><span class="pun">,</span><span class="pln">
			</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> buffer </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

				</span><span class="kwd">const</span><span class="pln"> listener </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> THREE</span><span class="pun">.</span><span class="typ">AudioListener</span><span class="pun">();</span><span class="pln">
				</span><span class="kwd">const</span><span class="pln"> audio </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> THREE</span><span class="pun">.</span><span class="typ">Audio</span><span class="pun">(</span><span class="pln"> listener </span><span class="pun">).</span><span class="pln">setBuffer</span><span class="pun">(</span><span class="pln"> buffer </span><span class="pun">);</span><span class="pln">

				listener</span><span class="pun">.</span><span class="pln">position</span><span class="pun">.</span><span class="pln">z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">

				scene</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln"> audio </span><span class="pun">);</span><span class="pln">
				scene</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="pln"> listener </span><span class="pun">);</span><span class="pln">

			</span><span class="pun">}</span><span class="pln">

		</span><span class="pun">);</span><span class="pln">

	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">);</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> render</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

	helper</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="pln"> clock</span><span class="pun">.</span><span class="pln">getDelta</span><span class="pun">()</span><span class="pln"> </span><span class="pun">);</span><span class="pln">
	renderer</span><span class="pun">.</span><span class="pln">render</span><span class="pun">(</span><span class="pln"> scene</span><span class="pun">,</span><span class="pln"> camera </span><span class="pun">);</span><span class="pln">

</span><span class="pun">}</span></code>

		<h2>Examples</h2>

		<p>
			<a href="../examples/#webgl_loader_mmd" target="_blank">webgl_loader_mmd</a><br>
			<a href="../examples/#webgl_loader_mmd_pose" target="_blank">webgl_loader_mmd_pose</a><br>
			<a href="../examples/#webgl_loader_mmd_audio" target="_blank">webgl_loader_mmd_audio</a>
		</p>

		<h2>Constructor</h2>

		<h3>MMDAnimationHelper( params : <span class="param">Object</span> )</h3>
		<p>
		<a class="links" data-fragment="Object" title="Object">params</a> — (optional)<br>
		</p>
		<ul>
			<li> <a class="links" data-fragment="Boolean" title="Boolean">sync</a> - Whether animation durations of added objects are synched. Default is true.</li>
			<li> <a class="links" data-fragment="Number" title="Number">afterglow</a> - Default is 0.0.</li>
			<li> <a class="links" data-fragment="Boolean" title="Boolean">resetPhysicsOnLoop</a> - Default is true.</li>
			<li> <a class="links" data-fragment="Boolean" title="Boolean">pmxAnimation</a> - If it is set to true, the helper follows the complex and costly PMX animation system.
			Try this option only if your PMX model animation doesn't work well. Default is false.</li>
		</ul>
		<p>
		Creates a new MMDAnimationHelper.
		</p>

		<h2>Properties</h2>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.audio" target="_parent" title="MMDAnimationHelper.audio" href="./index.html#examples/en/animations/MMDAnimationHelper.audio">#</a> .<a class="links" data-fragment="MMDAnimationHelper.audio" id="audio" href="./index.html#examples/en/animations/MMDAnimationHelper.audio">audio</a>  : <a class="param links" data-fragment="Audio" href="./index.html#api/en/audio/Audio">Audio</a></h3>
		<p>An <a class="links" data-fragment="Audio" title="Audio" href="./index.html#api/en/audio/Audio">Audio</a> added to helper.</p>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.camera" target="_parent" title="MMDAnimationHelper.camera" href="./index.html#examples/en/animations/MMDAnimationHelper.camera">#</a> .<a class="links" data-fragment="MMDAnimationHelper.camera" id="camera" href="./index.html#examples/en/animations/MMDAnimationHelper.camera">camera</a>  : <a class="param links" data-fragment="Camera" href="./index.html#api/en/cameras/Camera">Camera</a></h3>
		<p>An <a class="links" data-fragment="Camera" title="Camera" href="./index.html#api/en/cameras/Camera">Camera</a> added to helper.</p>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.meshes" target="_parent" title="MMDAnimationHelper.meshes" href="./index.html#examples/en/animations/MMDAnimationHelper.meshes">#</a> .<a class="links" data-fragment="MMDAnimationHelper.meshes" id="meshes" href="./index.html#examples/en/animations/MMDAnimationHelper.meshes">meshes</a>  : <span class="param">Array</span></h3>
		<p>An array of <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> added to helper.</p>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.objects" target="_parent" title="MMDAnimationHelper.objects" href="./index.html#examples/en/animations/MMDAnimationHelper.objects">#</a> .<a class="links" data-fragment="MMDAnimationHelper.objects" id="objects" href="./index.html#examples/en/animations/MMDAnimationHelper.objects">objects</a>  : <a class="param links" data-fragment="WeakMap">WeakMap</a></h3>
		<p>A <a class="links" data-fragment="WeakMap" title="WeakMap">WeakMap</a> which holds animation stuffs used in helper for objects added to helper. For example, you can access <a class="links" data-fragment="AnimationMixer" title="AnimationMixer" href="./index.html#api/en/animation/AnimationMixer">AnimationMixer</a> for an added <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> with "helper.objects.get( mesh ).mixer"</p>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.onBeforePhysics" target="_parent" title="MMDAnimationHelper.onBeforePhysics" href="./index.html#examples/en/animations/MMDAnimationHelper.onBeforePhysics">#</a> .<a class="links" data-fragment="MMDAnimationHelper.onBeforePhysics" id="onBeforePhysics" href="./index.html#examples/en/animations/MMDAnimationHelper.onBeforePhysics">onBeforePhysics</a>  : <a class="param links" data-fragment="Function">Function</a></h3>
		<p>An optional callback that is executed immediately before the physicis calculation for an <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>. This function is called with the <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>.</p>

		<h2>Methods</h2>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.add" target="_parent" title="MMDAnimationHelper.add" href="./index.html#examples/en/animations/MMDAnimationHelper.add">#</a> .<a class="links" data-fragment="MMDAnimationHelper.add" id="add" href="./index.html#examples/en/animations/MMDAnimationHelper.add">add</a> ( object : <a class="param links" data-fragment="Object3D" href="./index.html#api/en/core/Object3D">Object3D</a>, params : <span class="param">Object</span> ) : <a class="param links" data-fragment="MMDAnimationHelper" href="./index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a class="links" data-fragment="Object3D" title="Object3D" href="./index.html#api/en/core/Object3D">object</a> — <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, <a class="links" data-fragment="Camera" title="Camera" href="./index.html#api/en/cameras/Camera">Camera</a>, or <a class="links" data-fragment="Audio" title="Audio" href="./index.html#api/en/audio/Audio">Audio</a><br>
		<a class="links" data-fragment="Object" title="Object">params</a> — (optional)<br>
		</p>
		<ul>
			<li><a class="links" data-fragment="AnimationClip" title="AnimationClip" href="./index.html#api/en/animation/AnimationClip">animation</a> - an <a class="links" data-fragment="AnimationClip" title="AnimationClip" href="./index.html#api/en/animation/AnimationClip">AnimationClip</a> or an array of <a class="links" data-fragment="AnimationClip" title="AnimationClip" href="./index.html#api/en/animation/AnimationClip">AnimationClip</a> set to object. Only for <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and <a class="links" data-fragment="Camera" title="Camera" href="./index.html#api/en/cameras/Camera">Camera</a>. Default is undefined.</li>
			<li><a class="links" data-fragment="Boolean" title="Boolean">physics</a> - Only for <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>. A flag whether turn on physics. Default is true.</li>
			<li><a class="links" data-fragment="Integer" title="Integer">warmup</a> - Only for <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and physics is true. Physics parameter. Default is 60.</li>
			<li><a class="links" data-fragment="Number" title="Number">unitStep</a> - Only for <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and physics is true. Physics parameter. Default is 1 / 65.</li>
			<li><a class="links" data-fragment="Integer" title="Integer">maxStepNum</a> - Only for <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and physics is true. Physics parameter. Default is 3.</li>
			<li><a class="links" data-fragment="Vector3" title="Vector3" href="./index.html#api/en/math/Vector3">gravity</a> - Only for <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and physics is true. Physics parameter. Default is ( 0, - 9.8 * 10, 0 ).</li>
			<li><a class="links" data-fragment="Number" title="Number">delayTime</a> - Only for <a class="links" data-fragment="Audio" title="Audio" href="./index.html#api/en/audio/Audio">Audio</a>. Default is 0.0.</li>
		</ul>
		<p>
		Add an <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, <a class="links" data-fragment="Camera" title="Camera" href="./index.html#api/en/cameras/Camera">Camera</a>, or <a class="links" data-fragment="Audio" title="Audio" href="./index.html#api/en/audio/Audio">Audio</a> to helper and setup animation. The anmation durations of added objects are synched.
		If camera/audio has already been added, it'll be replaced with a new one.
		</p>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.enable" target="_parent" title="MMDAnimationHelper.enable" href="./index.html#examples/en/animations/MMDAnimationHelper.enable">#</a> .<a class="links" data-fragment="MMDAnimationHelper.enable" id="enable" href="./index.html#examples/en/animations/MMDAnimationHelper.enable">enable</a> ( key : <span class="param">String</span>, enabled : <span class="param">Boolean</span> ) : <a class="param links" data-fragment="MMDAnimationHelper" href="./index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a class="links" data-fragment="String" title="String">key</a> — Allowed strings are 'animation', 'ik', 'grant', 'physics', and 'cameraAnimation'.<br>
		<a class="links" data-fragment="Boolean" title="Boolean">enabled</a> — true is enable, false is disable<br>
		</p>
		<p>
		Enable/Disable an animation feature
		</p>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.pose" target="_parent" title="MMDAnimationHelper.pose" href="./index.html#examples/en/animations/MMDAnimationHelper.pose">#</a> .<a class="links" data-fragment="MMDAnimationHelper.pose" id="pose" href="./index.html#examples/en/animations/MMDAnimationHelper.pose">pose</a> ( mesh : <a class="param links" data-fragment="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, vpd : <span class="param">Object</span>, params : <span class="param">Object</span> ) : <a class="param links" data-fragment="MMDAnimationHelper" href="./index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">mesh</a> — <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> which changes the posing. It doesn't need to be added to helper.<br>
		<a class="links" data-fragment="Object" title="Object">vpd</a> — VPD content obtained by <a class="links" data-fragment="MMDLoader" title="MMDLoader" href="./index.html#examples/en/loaders/MMDLoader">MMDLoader</a>.loadVPD<br>
		<a class="links" data-fragment="Object" title="Object">params</a> — (optional)<br>
		</p>
		<ul>
			<li><a class="links" data-fragment="Boolean" title="Boolean">resetPose</a> - Default is true.</li>
			<li><a class="links" data-fragment="Boolean" title="Boolean">ik</a> - Default is true.</li>
			<li><a class="links" data-fragment="Boolean" title="Boolean">grant</a> - Default is true.</li>
		</ul>
		<p>
		Changes the posing of <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> as VPD content specifies.
		</p>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.remove" target="_parent" title="MMDAnimationHelper.remove" href="./index.html#examples/en/animations/MMDAnimationHelper.remove">#</a> .<a class="links" data-fragment="MMDAnimationHelper.remove" id="remove" href="./index.html#examples/en/animations/MMDAnimationHelper.remove">remove</a> ( object : <a class="param links" data-fragment="Object3D" href="./index.html#api/en/core/Object3D">Object3D</a> ) : <a class="param links" data-fragment="MMDAnimationHelper" href="./index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a class="links" data-fragment="Object3D" title="Object3D" href="./index.html#api/en/core/Object3D">object</a> — <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, <a class="links" data-fragment="Camera" title="Camera" href="./index.html#api/en/cameras/Camera">Camera</a>, or <a class="links" data-fragment="Audio" title="Audio" href="./index.html#api/en/audio/Audio">Audio</a><br>
		</p>
		<p>
		Remove an <a class="links" data-fragment="SkinnedMesh" title="SkinnedMesh" href="./index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, <a class="links" data-fragment="Camera" title="Camera" href="./index.html#api/en/cameras/Camera">Camera</a>, or <a class="links" data-fragment="Audio" title="Audio" href="./index.html#api/en/audio/Audio">Audio</a> from helper.
		</p>

		<h3><a class="permalink links" data-fragment="MMDAnimationHelper.update" target="_parent" title="MMDAnimationHelper.update" href="./index.html#examples/en/animations/MMDAnimationHelper.update">#</a> .<a class="links" data-fragment="MMDAnimationHelper.update" id="update" href="./index.html#examples/en/animations/MMDAnimationHelper.update">update</a> ( delta : <span class="param">Number</span> ) : <a class="param links" data-fragment="MMDAnimationHelper" href="./index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a class="links" data-fragment="Number" title="Number">delta</a> — number in second<br>
		</p>
		<p>
		Advance mixer time and update the animations of objects added to helper
		</p>

		<h2>Source</h2>

		<p>
			<a href="https://github.com/mrdoob/three.js/blob/master/examples/jsm/animation/MMDAnimationHelper.js" target="_blank">examples/jsm/animation/MMDAnimationHelper.js</a>
		</p>
	

<div id="button"><img src="../files/ic_mode_edit_black_24dp.svg"></div></body></body></html>