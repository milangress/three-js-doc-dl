<div id="readability-page-1" class="page"><div>
	<meta charset="utf-8">
	<base href="../../../">
	
	



	<h2>How to dispose of objects</h2>

	<p>
		One important aspect in order to improve performance and avoid memory leaks in your application is the disposal of unused library entities.
		Whenever you create an instance of a <strong>three.js</strong> type, you allocate a certain amount of memory. However, <strong>three.js</strong> creates for specific objects
		like geometries or materials WebGL related entities like buffers or shader programs which are necessary for rendering. It's important to
		highlight that these objects are not released automatically. Instead, the application has to use a special API in order to free such resources.
		This guide provides a brief overview about how this API is used and what objects are relevant in this context.
	</p>

	<h2>Geometries</h2>

	<p>
		A geometry usually represents vertex information defined as a collection of attributes. <strong>three.js</strong> internally creates an object of type <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLBuffer" target="_blank">WebGLBuffer</a>
		for each attribute. These entities are only deleted if you call <a data-fragment="BufferGeometry.dispose" title="BufferGeometry.dispose" href="https://threejs.org/docs/index.html#api/en/core/BufferGeometry.dispose">BufferGeometry.dispose</a>(). If a geometry becomes obsolete in your application,
		execute the method to free all related resources.
	</p>

	<h2>Materials</h2>

	<p>
		A material defines how objects are rendered. <strong>three.js</strong> uses the information of a material definition in order to construct a shader program for rendering.
		Shader programs can only be deleted if the respective material is disposed. For performance reasons, <strong>three.js</strong> tries to reuse existing
		shader programs if possible. So a shader program is only deleted if all related materials are disposed. You can indicate the disposal of a material by
		executing <a data-fragment="Material.dispose" title="Material.dispose" href="https://threejs.org/docs/index.html#api/en/materials/Material.dispose">Material.dispose</a>().
	</p>

	<h2>Textures</h2>

	<p>
		The disposal of a material has no effect on textures. They are handled separately since a single texture can be used by multiple materials at the same time.
		Whenever you create an instance of <a data-fragment="Texture" title="Texture" href="https://threejs.org/docs/index.html#api/en/textures/Texture">Texture</a>, three.js internally creates an instance of <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLTexture" target="_blank">WebGLTexture</a>.
		Similar to buffers, this object can only be deleted by calling <a data-fragment="Texture.dispose" title="Texture.dispose" href="https://threejs.org/docs/index.html#api/en/textures/Texture.dispose">Texture.dispose</a>().
	</p>

	<p>
		If you use an <code translate="no"><span>ImageBitmap</span></code> as the texture's data source, you have to call <a href="https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap/close" target="_blank">ImageBitmap.close</a>() at the application level to dispose of all CPU-side resources.
		An automated call of <code translate="no"><span>ImageBitmap</span><span>.</span><span>close</span><span>()</span></code> in <a data-fragment="Texture.dispose" title="Texture.dispose" href="https://threejs.org/docs/index.html#api/en/textures/Texture.dispose">Texture.dispose</a>() is not possible, since the image bitmap becomes unusable, and the engine has no way of knowing if the image bitmap is used elsewhere.
	</p>

	<h2>Render Targets</h2>

	<p>
		Objects of type <a data-fragment="WebGLRenderTarget" title="WebGLRenderTarget" href="https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderTarget">WebGLRenderTarget</a> not only allocate an instance of <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLTexture" target="_blank">WebGLTexture</a> but also
		<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLFramebuffer" target="_blank">WebGLFramebuffer</a>s and <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderbuffer" target="_blank">WebGLRenderbuffer</a>s
		for realizing custom rendering destinations. These objects are only deallocated by executing <a data-fragment="WebGLRenderTarget.dispose" title="WebGLRenderTarget.dispose" href="https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderTarget.dispose">WebGLRenderTarget.dispose</a>().
	</p>

	<h2>Miscellaneous</h2>

	<p>
		There are other classes from the examples directory like controls or post processing passes which provide <code translate="no"><span>dispose</span><span>()</span></code> methods in order to remove internal event listeners
		or render targets. In general, it's recommended to check the API or documentation of a class and watch for <code translate="no"><span>dispose</span><span>()</span></code>. If present, you should use it when cleaning things up.
	</p>

	<h2>FAQ</h2>

	<h3>Why can't <strong>three.js</strong> dispose objects automatically?</h3>

	<p>
		This question was asked many times by the community so it's important to clarify this matter. Fact is that <strong>three.js</strong> does not know the lifetime or scope
		of user-created entities like geometries or materials. This is the responsibility of the application. For example even if a material is currently not used for rendering,
		it might be necessary for the next frame. So if the application decides that a certain object can be deleted, it has to	notify the engine via calling the respective
		<code translate="no"><span>dispose</span><span>()</span></code> method.
	</p>

	<h3>Does removing a mesh from the scene also dispose its geometry and material?</h3>

	<p>
		No, you have to explicitly dispose the geometry and material via <strong>dispose()</strong>. Keep in mind that geometries and materials can be shared among 3D objects like meshes.
	</p>

	<h3>Does <strong>three.js</strong> provide information about the amount of cached objects?</h3>

	<p>
		Yes. It's possible to evaluate <a data-fragment="WebGLRenderer.info" title="WebGLRenderer.info" href="https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer.info">WebGLRenderer.info</a>, a special property of the renderer with a series of statistical information about the graphics board memory
		and the rendering process. Among other things, it tells you how many textures, geometries and shader programs are internally stored. If you notice performance problems
		in your application, it's a good idea to debug this property in order to easily identify a memory leak.
	</p>

	<h3>What happens when you call <code translate="no"><span>dispose</span><span>()</span></code> on a texture but the image is not loaded yet?</h3>

	<p>
		Internal resources for a texture are only allocated if the image has fully loaded. If you dispose a texture before the image was loaded,
		nothing happens. No resources were allocated so there is also no need for clean up.
	</p>

	<h3>What happens when I call <code translate="no"><span>dispose</span><span>()</span></code> and then use the respective object at a later point?</h3>

	<p>
		That depends. For geometries, materials, textures, render targets and post processing passes the deleted internal resources can be created again by the engine. 
		So no runtime error will occur but you might notice a negative performance impact for the current frame, especially when shader programs have to be compiled.

		Controls and renderers are an exception. Instances of these classes can not be used after <code translate="no"><span>dispose</span><span>()</span></code> has been called. You have to create new instances in this case.
	</p>

	<h3>How should I manage <strong>three.js</strong> objects in my app? When do I know how to dispose things?</h3>

	<p>
		In general, there is no definite recommendation for this. It highly depends on the specific use case when calling <code translate="no"><span>dispose</span><span>()</span></code> is appropriate. It's important to highlight that
		it's not always necessary to dispose objects all the time. A good example for this is a game which consists of multiple levels. A good place for object disposal is when
		switching the level. The app could traverse through the old scene and dispose all obsolete materials, geometries and textures. As mentioned in the previous section, it does not
		produce a runtime error if you dispose an object that is actually still in use. The worst thing that can happen is performance drop for a single frame.
	</p>

	<h2>Examples that demonstrate the usage of dispose()</h2>

	<p>
		<a href="https://threejs.org/examples/#webgl_test_memory" target="_blank">WebGL / test / memory</a><br>
		<a href="https://threejs.org/examples/#webgl_test_memory2" target="_blank">WebGL / test / memory2</a><br>
	</p>




<p><img src="https://threejs.org/files/ic_mode_edit_black_24dp.svg"></p></div></div>