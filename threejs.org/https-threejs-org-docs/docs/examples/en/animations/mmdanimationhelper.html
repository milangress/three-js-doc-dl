<div id="readability-page-1" class="page"><div>
		<meta charset="utf-8">
		<base href="../../../">
		
		
	
	
		

		<div><p> A animation helper for <a href="https://sites.google.com/view/evpvp/"><code translate="no"><span>MMD</span></code></a> resources. </p><p>
		MMDAnimationHelper handles animation of MMD assets loaded by <a data-fragment="MMDLoader" title="MMDLoader" href="https://threejs.org/docs/index.html#examples/en/loaders/MMDLoader">MMDLoader</a> with MMD special features as IK, Grant, and Physics.
		It uses <a data-fragment="CCDIKSolver" title="CCDIKSolver" href="https://threejs.org/docs/index.html#examples/en/animations/CCDIKSolver">CCDIKSolver</a> and <a data-fragment="MMDPhysics" title="MMDPhysics" href="https://threejs.org/docs/index.html#examples/en/animations/MMDPhysics">MMDPhysics</a> inside.
		</p></div>

		<h2>Import</h2>

		<p>
			MMDAnimationHelper is an add-on, and must be imported explicitly.
			See <a href="#manual/introduction/Installation" target="_blank">Installation / Addons</a>.
		</p>

		<p><code translate="no"><span>import</span><span> </span><span>{</span><span> </span><span>MMDAnimationHelper</span><span> </span><span>}</span><span> </span><span>from</span><span> </span><span>'three/addons/animation/MMDAnimationHelper.js'</span><span>;</span></code></p><h2>Code Example</h2>

		<p><code translate="no"><span>// Instantiate a helper</span><span>
</span><span>const</span><span> helper </span><span>=</span><span> </span><span>new</span><span> </span><span>MMDAnimationHelper</span><span>();</span><span>

</span><span>// Load MMD resources and add to helper</span><span>
</span><span>new</span><span> </span><span>MMDLoader</span><span>().</span><span>loadWithAnimation</span><span>(</span><span>
	</span><span>'models/mmd/miku.pmd'</span><span>,</span><span>
	</span><span>'models/mmd/dance.vmd'</span><span>,</span><span>
	</span><span>function</span><span> </span><span>(</span><span> mmd </span><span>)</span><span> </span><span>{</span><span>

		helper</span><span>.</span><span>add</span><span>(</span><span> mmd</span><span>.</span><span>mesh</span><span>,</span><span> </span><span>{</span><span>
			animation</span><span>:</span><span> mmd</span><span>.</span><span>animation</span><span>,</span><span>
			physics</span><span>:</span><span> </span><span>true</span><span>
		</span><span>}</span><span> </span><span>);</span><span>

		scene</span><span>.</span><span>add</span><span>(</span><span> mmd</span><span>.</span><span>mesh </span><span>);</span><span>

		</span><span>new</span><span> THREE</span><span>.</span><span>AudioLoader</span><span>().</span><span>load</span><span>(</span><span>
			</span><span>'audios/mmd/song.mp3'</span><span>,</span><span>
			</span><span>function</span><span> </span><span>(</span><span> buffer </span><span>)</span><span> </span><span>{</span><span>

				</span><span>const</span><span> listener </span><span>=</span><span> </span><span>new</span><span> THREE</span><span>.</span><span>AudioListener</span><span>();</span><span>
				</span><span>const</span><span> audio </span><span>=</span><span> </span><span>new</span><span> THREE</span><span>.</span><span>Audio</span><span>(</span><span> listener </span><span>).</span><span>setBuffer</span><span>(</span><span> buffer </span><span>);</span><span>

				listener</span><span>.</span><span>position</span><span>.</span><span>z </span><span>=</span><span> </span><span>1</span><span>;</span><span>

				scene</span><span>.</span><span>add</span><span>(</span><span> audio </span><span>);</span><span>
				scene</span><span>.</span><span>add</span><span>(</span><span> listener </span><span>);</span><span>

			</span><span>}</span><span>

		</span><span>);</span><span>

	</span><span>}</span><span>
</span><span>);</span><span>

</span><span>function</span><span> render</span><span>()</span><span> </span><span>{</span><span>

	helper</span><span>.</span><span>update</span><span>(</span><span> clock</span><span>.</span><span>getDelta</span><span>()</span><span> </span><span>);</span><span>
	renderer</span><span>.</span><span>render</span><span>(</span><span> scene</span><span>,</span><span> camera </span><span>);</span><span>

</span><span>}</span></code></p><h2>Examples</h2>

		<p>
			<a href="https://threejs.org/examples/#webgl_loader_mmd" target="_blank">webgl_loader_mmd</a><br>
			<a href="https://threejs.org/examples/#webgl_loader_mmd_pose" target="_blank">webgl_loader_mmd_pose</a><br>
			<a href="https://threejs.org/examples/#webgl_loader_mmd_audio" target="_blank">webgl_loader_mmd_audio</a>
		</p>

		<h2>Constructor</h2>

		<h3>MMDAnimationHelper( params : <span>Object</span> )</h3>
		<p>
		<a data-fragment="Object" title="Object">params</a> — (optional)<br>
		</p>
		<ul>
			<li> <a data-fragment="Boolean" title="Boolean">sync</a> - Whether animation durations of added objects are synched. Default is true.</li>
			<li> <a data-fragment="Number" title="Number">afterglow</a> - Default is 0.0.</li>
			<li> <a data-fragment="Boolean" title="Boolean">resetPhysicsOnLoop</a> - Default is true.</li>
			<li> <a data-fragment="Boolean" title="Boolean">pmxAnimation</a> - If it is set to true, the helper follows the complex and costly PMX animation system.
			Try this option only if your PMX model animation doesn't work well. Default is false.</li>
		</ul>
		<p>
		Creates a new MMDAnimationHelper.
		</p>

		<h2>Properties</h2>

		<h3><a data-fragment="MMDAnimationHelper.audio" target="_parent" title="MMDAnimationHelper.audio" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.audio">#</a> .<a data-fragment="MMDAnimationHelper.audio" id="audio" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.audio">audio</a>  : <a data-fragment="Audio" href="https://threejs.org/docs/index.html#api/en/audio/Audio">Audio</a></h3>
		<p>An <a data-fragment="Audio" title="Audio" href="https://threejs.org/docs/index.html#api/en/audio/Audio">Audio</a> added to helper.</p>

		<h3><a data-fragment="MMDAnimationHelper.camera" target="_parent" title="MMDAnimationHelper.camera" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.camera">#</a> .<a data-fragment="MMDAnimationHelper.camera" id="camera" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.camera">camera</a>  : <a data-fragment="Camera" href="https://threejs.org/docs/index.html#api/en/cameras/Camera">Camera</a></h3>
		<p>An <a data-fragment="Camera" title="Camera" href="https://threejs.org/docs/index.html#api/en/cameras/Camera">Camera</a> added to helper.</p>

		<h3><a data-fragment="MMDAnimationHelper.meshes" target="_parent" title="MMDAnimationHelper.meshes" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.meshes">#</a> .<a data-fragment="MMDAnimationHelper.meshes" id="meshes" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.meshes">meshes</a>  : <span>Array</span></h3>
		<p>An array of <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> added to helper.</p>

		<h3><a data-fragment="MMDAnimationHelper.objects" target="_parent" title="MMDAnimationHelper.objects" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.objects">#</a> .<a data-fragment="MMDAnimationHelper.objects" id="objects" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.objects">objects</a>  : <a data-fragment="WeakMap">WeakMap</a></h3>
		<p>A <a data-fragment="WeakMap" title="WeakMap">WeakMap</a> which holds animation stuffs used in helper for objects added to helper. For example, you can access <a data-fragment="AnimationMixer" title="AnimationMixer" href="https://threejs.org/docs/index.html#api/en/animation/AnimationMixer">AnimationMixer</a> for an added <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> with "helper.objects.get( mesh ).mixer"</p>

		<h3><a data-fragment="MMDAnimationHelper.onBeforePhysics" target="_parent" title="MMDAnimationHelper.onBeforePhysics" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.onBeforePhysics">#</a> .<a data-fragment="MMDAnimationHelper.onBeforePhysics" id="onBeforePhysics" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.onBeforePhysics">onBeforePhysics</a>  : <a data-fragment="Function">Function</a></h3>
		<p>An optional callback that is executed immediately before the physicis calculation for an <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>. This function is called with the <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>.</p>

		<h2>Methods</h2>

		<h3><a data-fragment="MMDAnimationHelper.add" target="_parent" title="MMDAnimationHelper.add" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.add">#</a> .<a data-fragment="MMDAnimationHelper.add" id="add" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.add">add</a> ( object : <a data-fragment="Object3D" href="https://threejs.org/docs/index.html#api/en/core/Object3D">Object3D</a>, params : <span>Object</span> ) : <a data-fragment="MMDAnimationHelper" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a data-fragment="Object3D" title="Object3D" href="https://threejs.org/docs/index.html#api/en/core/Object3D">object</a> — <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, <a data-fragment="Camera" title="Camera" href="https://threejs.org/docs/index.html#api/en/cameras/Camera">Camera</a>, or <a data-fragment="Audio" title="Audio" href="https://threejs.org/docs/index.html#api/en/audio/Audio">Audio</a><br>
		<a data-fragment="Object" title="Object">params</a> — (optional)<br>
		</p>
		<ul>
			<li><a data-fragment="AnimationClip" title="AnimationClip" href="https://threejs.org/docs/index.html#api/en/animation/AnimationClip">animation</a> - an <a data-fragment="AnimationClip" title="AnimationClip" href="https://threejs.org/docs/index.html#api/en/animation/AnimationClip">AnimationClip</a> or an array of <a data-fragment="AnimationClip" title="AnimationClip" href="https://threejs.org/docs/index.html#api/en/animation/AnimationClip">AnimationClip</a> set to object. Only for <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and <a data-fragment="Camera" title="Camera" href="https://threejs.org/docs/index.html#api/en/cameras/Camera">Camera</a>. Default is undefined.</li>
			<li><a data-fragment="Boolean" title="Boolean">physics</a> - Only for <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>. A flag whether turn on physics. Default is true.</li>
			<li><a data-fragment="Integer" title="Integer">warmup</a> - Only for <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and physics is true. Physics parameter. Default is 60.</li>
			<li><a data-fragment="Number" title="Number">unitStep</a> - Only for <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and physics is true. Physics parameter. Default is 1 / 65.</li>
			<li><a data-fragment="Integer" title="Integer">maxStepNum</a> - Only for <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and physics is true. Physics parameter. Default is 3.</li>
			<li><a data-fragment="Vector3" title="Vector3" href="https://threejs.org/docs/index.html#api/en/math/Vector3">gravity</a> - Only for <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> and physics is true. Physics parameter. Default is ( 0, - 9.8 * 10, 0 ).</li>
			<li><a data-fragment="Number" title="Number">delayTime</a> - Only for <a data-fragment="Audio" title="Audio" href="https://threejs.org/docs/index.html#api/en/audio/Audio">Audio</a>. Default is 0.0.</li>
		</ul>
		<p>
		Add an <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, <a data-fragment="Camera" title="Camera" href="https://threejs.org/docs/index.html#api/en/cameras/Camera">Camera</a>, or <a data-fragment="Audio" title="Audio" href="https://threejs.org/docs/index.html#api/en/audio/Audio">Audio</a> to helper and setup animation. The anmation durations of added objects are synched.
		If camera/audio has already been added, it'll be replaced with a new one.
		</p>

		<h3><a data-fragment="MMDAnimationHelper.enable" target="_parent" title="MMDAnimationHelper.enable" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.enable">#</a> .<a data-fragment="MMDAnimationHelper.enable" id="enable" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.enable">enable</a> ( key : <span>String</span>, enabled : <span>Boolean</span> ) : <a data-fragment="MMDAnimationHelper" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a data-fragment="String" title="String">key</a> — Allowed strings are 'animation', 'ik', 'grant', 'physics', and 'cameraAnimation'.<br>
		<a data-fragment="Boolean" title="Boolean">enabled</a> — true is enable, false is disable<br>
		</p>
		<p>
		Enable/Disable an animation feature
		</p>

		<h3><a data-fragment="MMDAnimationHelper.pose" target="_parent" title="MMDAnimationHelper.pose" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.pose">#</a> .<a data-fragment="MMDAnimationHelper.pose" id="pose" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.pose">pose</a> ( mesh : <a data-fragment="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, vpd : <span>Object</span>, params : <span>Object</span> ) : <a data-fragment="MMDAnimationHelper" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">mesh</a> — <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> which changes the posing. It doesn't need to be added to helper.<br>
		<a data-fragment="Object" title="Object">vpd</a> — VPD content obtained by <a data-fragment="MMDLoader" title="MMDLoader" href="https://threejs.org/docs/index.html#examples/en/loaders/MMDLoader">MMDLoader</a>.loadVPD<br>
		<a data-fragment="Object" title="Object">params</a> — (optional)<br>
		</p>
		<ul>
			<li><a data-fragment="Boolean" title="Boolean">resetPose</a> - Default is true.</li>
			<li><a data-fragment="Boolean" title="Boolean">ik</a> - Default is true.</li>
			<li><a data-fragment="Boolean" title="Boolean">grant</a> - Default is true.</li>
		</ul>
		<p>
		Changes the posing of <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a> as VPD content specifies.
		</p>

		<h3><a data-fragment="MMDAnimationHelper.remove" target="_parent" title="MMDAnimationHelper.remove" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.remove">#</a> .<a data-fragment="MMDAnimationHelper.remove" id="remove" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.remove">remove</a> ( object : <a data-fragment="Object3D" href="https://threejs.org/docs/index.html#api/en/core/Object3D">Object3D</a> ) : <a data-fragment="MMDAnimationHelper" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a data-fragment="Object3D" title="Object3D" href="https://threejs.org/docs/index.html#api/en/core/Object3D">object</a> — <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, <a data-fragment="Camera" title="Camera" href="https://threejs.org/docs/index.html#api/en/cameras/Camera">Camera</a>, or <a data-fragment="Audio" title="Audio" href="https://threejs.org/docs/index.html#api/en/audio/Audio">Audio</a><br>
		</p>
		<p>
		Remove an <a data-fragment="SkinnedMesh" title="SkinnedMesh" href="https://threejs.org/docs/index.html#api/en/objects/SkinnedMesh">SkinnedMesh</a>, <a data-fragment="Camera" title="Camera" href="https://threejs.org/docs/index.html#api/en/cameras/Camera">Camera</a>, or <a data-fragment="Audio" title="Audio" href="https://threejs.org/docs/index.html#api/en/audio/Audio">Audio</a> from helper.
		</p>

		<h3><a data-fragment="MMDAnimationHelper.update" target="_parent" title="MMDAnimationHelper.update" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.update">#</a> .<a data-fragment="MMDAnimationHelper.update" id="update" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper.update">update</a> ( delta : <span>Number</span> ) : <a data-fragment="MMDAnimationHelper" href="https://threejs.org/docs/index.html#examples/en/animations/MMDAnimationHelper">MMDAnimationHelper</a></h3>
		<p>
		<a data-fragment="Number" title="Number">delta</a> — number in second<br>
		</p>
		<p>
		Advance mixer time and update the animations of objects added to helper
		</p>

		<h2>Source</h2>

		<p>
			<a href="https://github.com/mrdoob/three.js/blob/master/examples/jsm/animation/MMDAnimationHelper.js" target="_blank">examples/jsm/animation/MMDAnimationHelper.js</a>
		</p>
	

<p><img src="https://threejs.org/files/ic_mode_edit_black_24dp.svg"></p></div></div>